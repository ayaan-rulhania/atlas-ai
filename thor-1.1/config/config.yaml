model:
  name: "all_rounder_model_v1_1_enhanced"
  architecture: "transformer"
  hidden_size: 1280  # Enhanced: Increased from 1024 for even better capacity
  num_layers: 20  # Enhanced: Increased from 16 for deeper understanding and reasoning
  num_heads: 20  # Enhanced: Increased from 16 for better multi-head attention
  intermediate_size: 5120  # Enhanced: Increased from 4096 for richer representations
  max_position_embeddings: 2048  # Enhanced: Increased from 1024 for much longer context
  vocab_size: 50257
  dropout: 0.06  # Enhanced: Further reduced for better learning and generalization
  activation_function: "gelu"  # Enhanced: GELU activation for better performance

  # Architecture improvements (configurable)
  use_flash_attn: true  # Enable Flash Attention 2.0 (reduces memory, speeds up inference)
  use_rmsnorm: true  # Use RMSNorm instead of LayerNorm (faster, less memory)
  use_swiglu: true  # Use SwiGLU instead of standard feed-forward (better performance)
  gradient_checkpointing: true  # Enable gradient checkpointing for memory efficiency

training:
  batch_size: 24  # Adjusted for larger model
  learning_rate: 8e-5  # Slightly lower for more stable training
  num_epochs: 12  # Increased from 10
  warmup_steps: 1500  # Increased warmup
  weight_decay: 0.01
  gradient_accumulation_steps: 2  # Increased for better gradient estimates
  max_grad_norm: 1.0
  save_steps: 800  # More frequent saves
  eval_steps: 400  # More frequent evaluation
  logging_steps: 50  # More frequent logging

tasks:
  - name: "text_classification"
    enabled: true
    num_labels: 2
  - name: "text_generation"
    enabled: true
    max_length: 512  # Enhanced: Increased from 128 for longer, more comprehensive responses
    temperature: 0.8  # Enhanced: Balanced creativity
    top_k: 50  # Enhanced: Top-k sampling
    top_p: 0.95  # Enhanced: Nucleus sampling
    repetition_penalty: 1.1  # Enhanced: Reduce repetition
  - name: "question_answering"
    enabled: true
    max_answer_length: 256  # Enhanced: Longer answers
  - name: "sentiment_analysis"
    enabled: true
    num_labels: 3
  - name: "named_entity_recognition"
    enabled: true
    num_labels: 9
  - name: "reasoning"  # Enhanced: New reasoning task
    enabled: true
    max_steps: 5  # Multi-step reasoning

data:
  train_path: "data/train.json"
  val_path: "data/val.json"
  test_path: "data/test.json"
  cache_dir: "cache"

output:
  model_dir: "models"
  log_dir: "logs"

device: "cpu"  # Change to "cuda" if you have a GPU

